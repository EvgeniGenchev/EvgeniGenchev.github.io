<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ASCII/Hex/Binary Converter</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex flex-col min-h-screen bg-gray-100">
  <main class="flex-grow flex items-center justify-center">
    <div class="bg-white p-8 rounded shadow-md w-full max-w-2xl text-center">
      <h1 class="text-2xl font-bold mb-2">ASCII, Hex, Binary, Decimal, Base64 Converter</h1>
      <p class="text-gray-600 mb-4">Type in any field to update all others:</p>

      <div class="mb-4 text-left">
        <label class="block mb-1 font-semibold">ASCII text</label>
        <textarea id="ascii" class="w-full border rounded p-3 resize-none" rows="2" placeholder="Type ASCII text..."></textarea>
      </div>

      <div class="mb-4 text-left">
        <label class="block mb-1 font-semibold">Hex (bytes)</label>
        <textarea id="hex" class="w-full border rounded p-3 resize-none" rows="2" placeholder="68 65 6C 6C 6F"></textarea>
      </div>

      <div class="mb-4 text-left">
        <label class="block mb-1 font-semibold">Binary (bytes)</label>
        <textarea id="binary" class="w-full border rounded p-3 resize-none" rows="3" placeholder="01101000 01100101..."></textarea>
      </div>

      <div class="mb-4 text-left">
        <label class="block mb-1 font-semibold">Decimal (bytes)</label>
        <textarea id="decimal" class="w-full border rounded p-3 resize-none" rows="2" placeholder="104 101 108..."></textarea>
      </div>

      <div class="mb-4 text-left">
        <label class="block mb-1 font-semibold">Base64</label>
        <textarea id="base64" class="w-full border rounded p-3 resize-none" rows="2" placeholder="aGVsbG8="></textarea>
      </div>

      <div class="mb-4 text-left">
        <label class="block mb-1 font-semibold">Length (bytes)</label>
        <input id="length" class="w-full border rounded p-3" readonly />
      </div>

      <div class="mb-4 text-left">
        <label class="block mb-1 font-semibold">Checksum (8-bit sum mod 256)</label>
        <input id="checksum" class="w-full border rounded p-3" readonly />
      </div>
    </div>
  </main>

  <footer class="bg-white text-center text-gray-500 py-4">
    Created by Evgeni Genchev
  </footer>

  <script>
    const asciiInput = document.getElementById("ascii");
    const hexInput = document.getElementById("hex");
    const binaryInput = document.getElementById("binary");
    const decimalInput = document.getElementById("decimal");
    const base64Input = document.getElementById("base64");
    const lengthOutput = document.getElementById("length");
    const checksumOutput = document.getElementById("checksum");

    const inputs = [asciiInput, hexInput, binaryInput, decimalInput, base64Input];

    function updateAll(fromField) {
      let bytes = [];

      try {
        switch (fromField) {
          case "ascii":
            bytes = Array.from(asciiInput.value).map(c => c.charCodeAt(0));
            break;
          case "hex":
            bytes = hexInput.value.trim().split(/\s+/).map(h => parseInt(h, 16));
            break;
          case "binary":
            bytes = binaryInput.value.trim().split(/\s+/).map(b => parseInt(b, 2));
            break;
          case "decimal":
            bytes = decimalInput.value.trim().split(/\s+/).map(d => parseInt(d, 10));
            break;
          case "base64":
            const decoded = atob(base64Input.value.trim());
            bytes = Array.from(decoded).map(c => c.charCodeAt(0));
            break;
        }

        // Avoid updating if invalid parse
        if (bytes.some(isNaN)) throw new Error("Invalid data");

        // Update all fields except the one being typed
        if (fromField !== "ascii") {
          asciiInput.value = bytes.map(b => String.fromCharCode(b)).join("");
        }
        if (fromField !== "hex") {
          hexInput.value = bytes.map(b => b.toString(16).padStart(2, "0").toUpperCase()).join(" ");
        }
        if (fromField !== "binary") {
          binaryInput.value = bytes.map(b => b.toString(2).padStart(8, "0")).join(" ");
        }
        if (fromField !== "decimal") {
          decimalInput.value = bytes.map(b => b.toString(10)).join(" ");
        }
        if (fromField !== "base64") {
          base64Input.value = btoa(String.fromCharCode(...bytes));
        }

        lengthOutput.value = bytes.length;
        checksumOutput.value = bytes.reduce((sum, b) => sum + b, 0) % 256;
      } catch (e) {
        // Graceful fallback: clear fields on error
        console.warn("Parse error:", e.message);
      }
    }

    inputs.forEach(input => {
      input.addEventListener("input", () => updateAll(input.id));
    });

    window.addEventListener("DOMContentLoaded", () => updateAll("ascii"));
  </script>
</body>
</html>
